flowchart TD
    subgraph Policy["OPA Decision Plane"]
        OPA[ðŸ§  OPA Engine] --> LOGS[ðŸ“„ Decision Logs]
    end

    subgraph Forwarder["ðŸ“¡ Forwarder"]
        LOGS --> FWD[Forward_to_SIEM.sh]
    end

    subgraph SOC["ðŸ›°ï¸ Mock SIEM / SOC"]
        FWD --> SIEM[SIEM Receiver (Node.js)]
        SIEM --> Dashboard[ðŸ“Š Dashboard / Alerts]
    end

    subgraph Containment["âš™ï¸ Auto Response"]
        SIEM --> Action[ðŸš¨ Block, Quarantine, Alert]
    end

    style OPA fill:#e6f7ff,stroke:#4d94ff,stroke-width:2px
    style FWD fill:#fff0f5,stroke:#ff69b4,stroke-width:2px
    style SIEM fill:#f0fff0,stroke:#66cc66,stroke-width:2px
    style Action fill:#fff5e6,stroke:#ff9900,stroke-width:2px
